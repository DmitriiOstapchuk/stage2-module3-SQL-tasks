select s.* from subject s join (select subject_id, avg(mark) as avg_mark from mark group by subject_id) as sam on sam.subject_id = s.id where sam.avg_mark > (select AVG(mark) from mark);
select s.* from student s join (select student_id, sum(amount) as student_sum from payment group by student_id) as student_sum_payments on student_sum_payments.student_id = s.id where student_sum_payments.student_sum < (select AVG(student_sum) from (select student_id, sum(amount) as student_sum from payment group by student_id));